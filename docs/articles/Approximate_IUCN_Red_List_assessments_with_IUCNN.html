<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Approximate_IUCN_Red_List_assessments_with_IUCNN • IUCNN</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Approximate_IUCN_Red_List_assessments_with_IUCNN">
<meta property="og:description" content="IUCNN">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">IUCNN</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.9.1</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../index.html">
    <span class="fas fa fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/Approximate_IUCN_Red_List_assessments_with_IUCNN.html">Approximate_IUCN_Red_List_assessments_with_IUCNN</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/azizka/IUCNN/">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><script src="Approximate_IUCN_Red_List_assessments_with_IUCNN_files/accessible-code-block-0.0.1/empty-anchor.js"></script><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>Approximate_IUCN_Red_List_assessments_with_IUCNN</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/azizka/IUCNN/blob/master/vignettes/Approximate_IUCN_Red_List_assessments_with_IUCNN.Rmd"><code>vignettes/Approximate_IUCN_Red_List_assessments_with_IUCNN.Rmd</code></a></small>
      <div class="hidden name"><code>Approximate_IUCN_Red_List_assessments_with_IUCNN.Rmd</code></div>

    </div>

    
    
<div id="introduction" class="section level1">
<h1 class="hasAnchor">
<a href="#introduction" class="anchor"></a>Introduction</h1>
<p>The conservation assessments of the Global Red List of the International Union for the Conservation of nature (www.iucn.org), are arguably one of the most thorough and widely used tools to assess the global extinction risk of species. However, IUCN assessments—usually performed by a group of specialists for each taxonomic group, or professional assessors—are time and data intense, and therefore a large fraction of global plant and animal species have not yet been evaluated. IUCNN implements neural networks to predict the IUCN status of so far not evaluated or data deficient species based on publicly available geographic distribution and environmental data and existing red lists from other species. A typical application example are to predict conservation status of some plant species using all evaluated species in the same family as training data.</p>
<div class="sourceCode" id="cb1"><html><body><pre class="r"><span class="fu"><a href="https://rdrr.io/r/base/library.html">library</a></span>(<span class="no">IUCNN</span>)
<span class="fu"><a href="https://rdrr.io/r/base/library.html">library</a></span>(<span class="no">magrittr</span>)
<span class="fu"><a href="https://rdrr.io/r/base/library.html">library</a></span>(<span class="no">dplyr</span>)</pre></body></html></div>
</div>
<div id="installation" class="section level1">
<h1 class="hasAnchor">
<a href="#installation" class="anchor"></a>Installation</h1>
<p>IUCNN uses R and python, so multiple steps are necessary to install IUCNN.</p>
<ol style="list-style-type: decimal">
<li>install IUCNN directly from Github using devtools.</li>
</ol>
<div class="sourceCode" id="cb2"><html><body><pre class="r"><span class="fu"><a href="https://rdrr.io/r/utils/install.packages.html">install.packages</a></span>(<span class="st">"devtools"</span>)
<span class="fu"><a href="https://rdrr.io/r/base/library.html">library</a></span>(<span class="no">devtools</span>)

<span class="fu"><a href="https://devtools.r-lib.org//reference/remote-reexports.html">install_github</a></span>(<span class="st">"azizka/IUCNN"</span>)</pre></body></html></div>
<ol start="2" style="list-style-type: decimal">
<li>Python needs to be installed, for instance using miniconda and reticulated from within R (this will need c. 3 GB disk space). If problems occur at this step, check the excellent <a href="https://rstudio.github.io/reticulate/index.html">documentation of reticulate</a>.</li>
</ol>
<div class="sourceCode" id="cb3"><html><body><pre class="r"><span class="fu"><a href="https://rdrr.io/r/utils/install.packages.html">install.packages</a></span>(<span class="no">reticulate</span>)
<span class="fu"><a href="https://rdrr.io/r/base/library.html">library</a></span>(<span class="no">reticulate</span>)
<span class="fu"><a href="https://rdrr.io/pkg/reticulate/man/install_miniconda.html">install_miniconda</a></span>()</pre></body></html></div>
<p>If python has been installed before, you can specify the python version to sue with <code><a href="https://rdrr.io/pkg/reticulate/man/use_python.html">reticulate::use_python()</a></code></p>
<ol start="3" style="list-style-type: decimal">
<li>Install the tensorflow module</li>
</ol>
<div class="sourceCode" id="cb4"><html><body><pre class="r"><span class="kw pkg">reticulate</span><span class="kw ns">::</span><span class="fu"><a href="https://rdrr.io/pkg/reticulate/man/py_install.html">py_install</a></span>(<span class="st">"tensorflow==2.0.0"</span>, <span class="kw">pip</span> <span class="kw">=</span> <span class="fl">TRUE</span>)</pre></body></html></div>
</div>
<div id="usage" class="section level1">
<h1 class="hasAnchor">
<a href="#usage" class="anchor"></a>Usage</h1>
<div id="input-data" class="section level2">
<h2 class="hasAnchor">
<a href="#input-data" class="anchor"></a>Input data</h2>
<p>IUCNN predicts the IUCN Global Red List assessment categories of Not Evaluated and Data Deficient species based on geographic occurrence records and a set of training species for which occurrence records and IUCN assessments are available (training data). The amount of training species necessary varies with the number of categories but in general “the more, the better”. Ideally, the training dataset should comprise several hundred species, so a typical scenario will be to use all available plant species from a region, or all available species from a plant family. If the availability of training species is limited, a good option can be to predict possibly threatened (IUCN categories “CR”, “EN”, and “VU”) vs. not threatened species (“NT” and “LC”).</p>
<p>Hence, three types of input are necessary, which are easily available for many species:</p>
<div id="geographic-occurrence-records-of-training-species-training-occurrences" class="section level3">
<h3 class="hasAnchor">
<a href="#geographic-occurrence-records-of-training-species-training-occurrences" class="anchor"></a>1. Geographic occurrence records of training species (training occurrences)</h3>
<p>Occurrence records might stem from a variety of databases, For example, from field collections or public databases such BIEN (<a href="https://bien.nceas.ucsb.edu/bien/" class="uri">https://bien.nceas.ucsb.edu/bien/</a>) or GBIF (www.gbif.org). GBIF data can be obtained from within R via the rbif package, See <a href="https://ropensci.org/tutorials/rgbif_tutorial/">here</a> for a tutorial on how to do so. IUCNN needs a dataset with (at least) three columns, containing the species name, decimal longitude coordinates and decimal latitude coordinates.</p>
</div>
<div id="iucn-global-red-list-assessment-of-the-training-species-training-labels" class="section level3">
<h3 class="hasAnchor">
<a href="#iucn-global-red-list-assessment-of-the-training-species-training-labels" class="anchor"></a>2. IUCN Global Red List assessment of the training species (training labels)</h3>
<p>These can be obtained from IUCN, either via the webpage www.iucn.org or via the rredlist package from inside R (preferred for many species). See <a href="https://ropensci.org/tutorials/rredlist_tutorial/">here</a> for a tutorial on how to use rredlist. It is important, that all target label classes are well represented in the training data, which is rarely the case for IUCN data, since for instance “VU” is rare. If the classes are to imbalance, consider using possibly threatened (IUCN categories “CR”, “EN”, and “VU”) vs. not threatened species (“NT” and “LC”).</p>
</div>
<div id="geographic-occurrence-records-of-the-species-for-which-the-iucn-status-should-be-predicted-predict-occurrences" class="section level3">
<h3 class="hasAnchor">
<a href="#geographic-occurrence-records-of-the-species-for-which-the-iucn-status-should-be-predicted-predict-occurrences" class="anchor"></a>3. Geographic occurrence records of the species for which the IUCN status should be predicted (predict occurrences)</h3>
<p>Geographic occurrence for the target species, in the same format as for the training occurrences above.</p>
<p>Example dataset are available with IUCNN: <code><a href="https://rdrr.io/r/utils/data.html">data(training_occ)</a></code> (training occurrences), <code><a href="https://rdrr.io/r/utils/data.html">data(labels_detail)</a></code> (training labels) and <code><a href="https://rdrr.io/r/utils/data.html">data(prediction_occ)</a></code>.</p>
</div>
</div>
<div id="feature-and-label-preparation" class="section level2">
<h2 class="hasAnchor">
<a href="#feature-and-label-preparation" class="anchor"></a>Feature and label preparation</h2>
<p>IUCNN uses sets of per species traits (“features”). Necessary is an input data.frame, with a species column, and then numerical columns indicating the feature values for each species. In general, features might represent any species trait, including from taxonomy (family), anatomy (body size), ecology (e.g., feeding guild) or conservation (e. g., population dynamics). Any of these features can be provided to IUCNN. However, since most of these data are scarce for many taxonomic groups, in most cases features will be based on geographic occurrences and auxiliary data alone. The IUCNN package contains convenience functions to obtain geographic features (number of occurrences, number of unique occurrences, mean latitude, mean longitude, latitudinal range, longitudinal range, the extend of occurrence, the area of occupancy and hemisphere), climatic features (median values per species from 19 bioclim variables from www.worldclim.org) and biome features (presence in global biomes from the <a href="https://www.worldwildlife.org/publications/terrestrial-ecoregions-of-the-world">WWF</a>) based on occurrence records. In this tutorial, we will use the example datasets from the Orchid family (Orchidaceae) provided with the IUCNN package,</p>
<div class="sourceCode" id="cb5"><html><body><pre class="r"><span class="fu"><a href="https://rdrr.io/r/utils/data.html">data</a></span>(<span class="st">"training_occ"</span>) <span class="co">#geographic occurrences of species with IUCN assessment</span>
<span class="fu"><a href="https://rdrr.io/r/utils/data.html">data</a></span>(<span class="st">"prediction_occ"</span>)

<span class="co"># prepare features for training data</span>
<span class="fu"><a href="https://rdrr.io/r/base/invisible.html">invisible</a></span>(<span class="no">geo</span> <span class="kw">&lt;-</span> <span class="fu"><a href="../reference/geo_features.html">geo_features</a></span>(<span class="no">training_occ</span>)) <span class="co">#geographic</span>
<span class="no">cli</span> <span class="kw">&lt;-</span> <span class="fu"><a href="../reference/clim_features.html">clim_features</a></span>(<span class="no">training_occ</span>) <span class="co">#climate</span>
<span class="no">bme</span> <span class="kw">&lt;-</span> <span class="fu"><a href="../reference/biome_features.html">biome_features</a></span>(<span class="no">training_occ</span>) <span class="co">#biomes</span>

<span class="no">features_train</span> <span class="kw">&lt;-</span> <span class="no">geo</span> <span class="kw">%&gt;%</span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate-joins.html">left_join</a></span>(<span class="no">cli</span>) <span class="kw">%&gt;%</span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate-joins.html">left_join</a></span>(<span class="no">bme</span>)

<span class="co"># prepare features for target species</span>
<span class="fu"><a href="https://rdrr.io/r/base/invisible.html">invisible</a></span>(<span class="no">geo</span> <span class="kw">&lt;-</span> <span class="fu"><a href="../reference/geo_features.html">geo_features</a></span>(<span class="no">prediction_occ</span>))
<span class="no">cli</span> <span class="kw">&lt;-</span> <span class="fu"><a href="../reference/clim_features.html">clim_features</a></span>(<span class="no">prediction_occ</span>)
<span class="no">bme</span> <span class="kw">&lt;-</span> <span class="fu"><a href="../reference/biome_features.html">biome_features</a></span>(<span class="no">prediction_occ</span>)

<span class="no">features_predict</span> <span class="kw">&lt;-</span> <span class="no">geo</span> <span class="kw">%&gt;%</span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate-joins.html">left_join</a></span>(<span class="no">cli</span>) <span class="kw">%&gt;%</span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate-joins.html">left_join</a></span>(<span class="no">bme</span>)</pre></body></html></div>
<p>IUCNN expects the labels for training as numerical categories. So, to use IUCN Red List categories, those need to be converted to numeric in the right way. This can be done using the <code>prepare_labels</code> function. The function can use with detailed categories or with broader threatened not threatened categories. See <code><a href="../reference/prepare_labels.html">?prepare_labels</a></code> for more information. The labels will be converted into numeric categories following the <code>accepted_labels</code> argument, so for instance, in the default case: CR -&gt; 0 and LC -&gt; 4. If you change the accepted labels, the match will change accordingly.</p>
<div class="sourceCode" id="cb6"><html><body><pre class="r"><span class="fu"><a href="https://rdrr.io/r/utils/data.html">data</a></span>(<span class="st">"training_labels"</span>)

<span class="no">labels_train</span> <span class="kw">&lt;-</span> <span class="fu"><a href="../reference/prepare_labels.html">prepare_labels</a></span>(<span class="no">training_labels</span>)</pre></body></html></div>
</div>
<div id="model-training" class="section level2">
<h2 class="hasAnchor">
<a href="#model-training" class="anchor"></a>Model training</h2>
<p>Based on the training features and labels, IUCNN trains a neural network, using the tensorflow module. The training is done vie the <code>train_iucnn</code> function. There are multiple options to change the design of the network, including among others the number of layers, and the fraction of records used for testing and validation. The <code>train_iucnn</code> function will write a folder to the working directory containing the model and print summary statistics to the screen.</p>
<div class="sourceCode" id="cb7"><html><body><pre class="r"><span class="fu"><a href="../reference/train_iucnn.html">train_iucnn</a></span>(<span class="kw">x</span> <span class="kw">=</span> <span class="no">features_train</span>,
            <span class="kw">labels</span> <span class="kw">=</span> <span class="no">labels_train</span>,
            <span class="kw">model_name</span> <span class="kw">=</span> <span class="st">"iuc_nn_model"</span>)</pre></body></html></div>
</div>
</div>
<div id="predict-iucn-global-red-list-status" class="section level1">
<h1 class="hasAnchor">
<a href="#predict-iucn-global-red-list-status" class="anchor"></a>Predict IUCN Global Red List status</h1>
<p>The trained model can then predict the conservation status of Not Evaluated and Data Deficient species with the <code>predict_iucnn</code> function. The output is a a data.frame with species names and numeric labels (as generated with prepare_labels).</p>
<div class="sourceCode" id="cb8"><html><body><pre class="r"><span class="fu"><a href="../reference/predict_iucnn.html">predict_iucnn</a></span>(<span class="kw">x</span> <span class="kw">=</span> <span class="no">features_predict</span>,
              <span class="kw">model_dir</span> <span class="kw">=</span> <span class="st">"iuc_nn_model"</span>)
<span class="co">#&gt; # A tibble: 100 x 2</span>
<span class="co">#&gt;    species                  ...2</span>
<span class="co">#&gt;    &lt;chr&gt;                   &lt;dbl&gt;</span>
<span class="co">#&gt;  1 Aa trilobulata              3</span>
<span class="co">#&gt;  2 Aeranthes peyrotii          3</span>
<span class="co">#&gt;  3 Angraecum erectum           3</span>
<span class="co">#&gt;  4 Angraecum lisowskianum      3</span>
<span class="co">#&gt;  5 Appendicula celebica        1</span>
<span class="co">#&gt;  6 Barkeria whartoniana        0</span>
<span class="co">#&gt;  7 Batemannia leferenzii       3</span>
<span class="co">#&gt;  8 Bonatea rabaiensis          3</span>
<span class="co">#&gt;  9 Brassia thyrsodes           3</span>
<span class="co">#&gt; 10 Bulbophyllum bulliferum     3</span>
<span class="co">#&gt; # ... with 90 more rows</span></pre></body></html></div>
<p>It is important to remember the following points when using IUCNN:</p>
<ol style="list-style-type: decimal">
<li><p>The resulting IUCNN categories are predictions. While IUCNN has reached accuracies between 80 and 90% on the broad (threatened vs non-threatened) level and up to 80% on the detailed level, some species will be mis-classified.</p></li>
<li><p>IUCNN is indifferent to the provided features. On the one hand this means that any species traits for which data is available can bes used, but on the other hand this means that thought is needed in the choice of the features. The default features of IUCNN are usually a safe choice. The number of features is not limited, but currently IUCNN does not support missing values in the feature table and removes species with missing values.</p></li>
<li><p>IUCNN is indifferent to the relation between training and test data. So it is possible to use training data from Palearctic birds to predict the conservation status of South American Nematodes. This is not recommended. Instead, a better approach will be to predict the conservation status of species, from training data of the same genus, order, or family. Alternatively, training data could be chosen on geographic region or functional aspects (e.g., feeding guilt or body size). However some inclusion of taxonomy/evolutionary history for the choice of training data is recommended.</p></li>
<li><p>The amount of training data is important. The more the better. Minimum several hundred training species with a more or less equal distribution on the label classes should be included. If training data is limited, the broader Threatened/Not threatened level is recommended.</p></li>
<li><p>IUCNN predictions are not equivalent to full IUCN Red List assessments. We see the main purpose of IUCNN in 1) identifying species that will likely need conservation action to trigger a full IUCN assessment , and 2) provide large-scale overviews on the extinction risk in a given taxonomic group, for instance in a macro-ecological and macro-evolutionary context.</p></li>
</ol>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p>Developed by Alexander Zizka.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.5.1.</p>
</div>

      </footer>
</div>

  


  </body>
</html>
