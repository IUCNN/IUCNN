<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Train an IUCNN Model — iucnn_train_model • IUCNN</title>


<!-- jquery -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script>
<!-- Bootstrap -->

<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous" />

<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script>

<!-- bootstrap-toc -->
<link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script>

<!-- Font Awesome icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous" />

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script>

<!-- headroom.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script>




<meta property="og:title" content="Train an IUCNN Model — iucnn_train_model" />
<meta property="og:description" content="Trains an IUCNN model based on a data.frame of features for a set of species,
generated by iucnn_prepare_features,
and the corresponding IUCN classes formatted as a iucnn_labels object
with iucnn_prepare_labels. Note
that NAs are not allowed in the features, and taxa with NAs will
automatically be removed! Taxa, for which information is only present in one
of the two input objects will be removed as well." />




<!-- mathjax -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->



  </head>

  <body data-spy="scroll" data-target="#toc">
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">IUCNN</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">2.0.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../index.html">
    <span class="fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="../articles/Approximate_IUCN_Red_List_assessments_with_IUCNN.html">Approximate IUCN Red List assessments with IUCNN</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://github.com/azizka/IUCNN/">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Train an IUCNN Model</h1>
    <small class="dont-index">Source: <a href='https://github.com/azizka/IUCNN/blob/master/R/iucnn_train_model.R'><code>R/iucnn_train_model.R</code></a></small>
    <div class="hidden name"><code>iucnn_train_model.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>Trains an IUCNN model based on a data.frame of features for a set of species,
generated by <code><a href='iucnn_prepare_features.html'>iucnn_prepare_features</a></code>,
and the corresponding IUCN classes formatted as a iucnn_labels object
with <code><a href='iucnn_prepare_labels.html'>iucnn_prepare_labels</a></code>. Note
that NAs are not allowed in the features, and taxa with NAs will
automatically be removed! Taxa, for which information is only present in one
of the two input objects will be removed as well.</p>
    </div>

    <pre class="usage"><span class='fu'>iucnn_train_model</span><span class='op'>(</span>
  <span class='va'>x</span>,
  <span class='va'>lab</span>,
  path_to_output <span class='op'>=</span> <span class='st'>"iuc_nn_model"</span>,
  production_model <span class='op'>=</span> <span class='cn'>NULL</span>,
  mode <span class='op'>=</span> <span class='st'>"nn-class"</span>,
  test_fraction <span class='op'>=</span> <span class='fl'>0.2</span>,
  cv_fold <span class='op'>=</span> <span class='fl'>1</span>,
  seed <span class='op'>=</span> <span class='fl'>1234</span>,
  max_epochs <span class='op'>=</span> <span class='fl'>1000</span>,
  patience <span class='op'>=</span> <span class='fl'>200</span>,
  n_layers <span class='op'>=</span> <span class='st'>"50_30_10"</span>,
  use_bias <span class='op'>=</span> <span class='cn'>TRUE</span>,
  balance_classes <span class='op'>=</span> <span class='cn'>FALSE</span>,
  act_f <span class='op'>=</span> <span class='st'>"auto"</span>,
  act_f_out <span class='op'>=</span> <span class='st'>"auto"</span>,
  label_stretch_factor <span class='op'>=</span> <span class='fl'>1</span>,
  randomize_instances <span class='op'>=</span> <span class='cn'>TRUE</span>,
  dropout_rate <span class='op'>=</span> <span class='fl'>0</span>,
  mc_dropout <span class='op'>=</span> <span class='cn'>TRUE</span>,
  mc_dropout_reps <span class='op'>=</span> <span class='fl'>100</span>,
  label_noise_factor <span class='op'>=</span> <span class='fl'>0</span>,
  rescale_features <span class='op'>=</span> <span class='cn'>FALSE</span>,
  save_model <span class='op'>=</span> <span class='cn'>TRUE</span>,
  overwrite <span class='op'>=</span> <span class='cn'>FALSE</span>,
  verbose <span class='op'>=</span> <span class='fl'>1</span>
<span class='op'>)</span></pre>

    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a>Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>x</th>
      <td><p>a data.set, containing a column "species"
with the species names, and
subsequent columns with different features.</p></td>
    </tr>
    <tr>
      <th>lab</th>
      <td><p>an object of the class iucnn_labels, as generated by
<code><a href='iucnn_prepare_labels.html'>iucnn_prepare_labels</a></code> containing the labels for all species.</p></td>
    </tr>
    <tr>
      <th>path_to_output</th>
      <td><p>character string. The path to the location
where the IUCNN model shall be saved</p></td>
    </tr>
    <tr>
      <th>production_model</th>
      <td><p>an object of type iucnn_model (default=NULL).
If an iucnn_model is provided, <code>iucnn_train_model</code> will read the settings of
this model and reproduce it, but use all available data for training, by
automatically setting the validation set to 0 and cv_fold to 1. This is
recommended before using the model for predicting the IUCN status of
not evaluated species, as it generally improves the prediction
accuracy of the model. Choosing this option will ignore all other provided
settings (below).</p></td>
    </tr>
    <tr>
      <th>mode</th>
      <td><p>character string. Choose between the IUCNN models
"nn-class" (default, tensorflow neural network classifier),
"nn-reg" (tensorflow neural network regression), or
"bnn-class" (Bayesian neural network classifier)</p></td>
    </tr>
    <tr>
      <th>test_fraction</th>
      <td><p>numeric. The fraction of the input data used as
test set.</p></td>
    </tr>
    <tr>
      <th>cv_fold</th>
      <td><p>integer (default=1). When setting cv_fold &gt; 1,
<code>iucnn_train_model</code> will perform k-fold cross-validation. In this case, the
provided setting for test_fraction will be ignored, as the validation
size of each CV-fold is determined by the specified number provided here.</p></td>
    </tr>
    <tr>
      <th>seed</th>
      <td><p>integer. Set a starting seed for reproducibility.</p></td>
    </tr>
    <tr>
      <th>max_epochs</th>
      <td><p>integer. The maximum number of epochs.</p></td>
    </tr>
    <tr>
      <th>patience</th>
      <td><p>integer. Number of epochs with no improvement
after which training will be stopped.</p></td>
    </tr>
    <tr>
      <th>n_layers</th>
      <td><p>character string. Define number node per layer by providing a
character string where the number of nodes for each layer are separated by
underscores. E.g. '50_30_10' (default) will train a model with 3 hidden layers with
50, 30, and 10 nodes respectively. Note that the number of nodes in the output
layer is automatically determined based on
the number of unique labels in the training set.</p></td>
    </tr>
    <tr>
      <th>use_bias</th>
      <td><p>logical (default=TRUE). Specifies if a bias node is used in
the first hidden layer.</p></td>
    </tr>
    <tr>
      <th>balance_classes</th>
      <td><p>logical (default=FALSE). If set to TRUE,
<code>iucnn_train_model</code> will perform supersampling of the training instances to
account for uneven class distribution in the training data. If case of
training an bnn-class model, choosing this option will add the estimation
of class weights instead, to account for class imbalances.</p></td>
    </tr>
    <tr>
      <th>act_f</th>
      <td><p>character string. Specifies the activation
function should be used in the hidden layers.
Available options are: "relu", "tanh", "sigmoid", or "swish" (latter only for
bnn-class). If set to 'auto' (default), <code>iucnn_train_model</code> will pick a reasonable
default ('relu' for nn-class or nn-reg, and 'swish' for bnn-class).</p></td>
    </tr>
    <tr>
      <th>act_f_out</th>
      <td><p>character string. Similar to act_f, this specifies
the activation function for the output
layer. Available options are "softmax" (nn-class, bnn-class), "tanh" (nn-reg),
"sigmoid" (nn-reg), or no activation function "" (nn-reg). When set to "auto"
(default), a suitable output activation function will be chosen based on the
chosen mode ('softmax' for nn-class or bnn-class, 'tanh' for nn-reg).</p></td>
    </tr>
    <tr>
      <th>label_stretch_factor</th>
      <td><p>numeric (only for mode nn-reg). The provided
value will be applied as a factor to stretch or compress the labels before
training a regression model. A factor smaller &lt; 1.0 will compress the range
of labels, while a factor &gt; 1 will stretch the range.</p></td>
    </tr>
    <tr>
      <th>randomize_instances</th>
      <td><p>logical. When set to TRUE (default) the
instances will be shuffled before training (recommended).</p></td>
    </tr>
    <tr>
      <th>dropout_rate</th>
      <td><p>numeric. This will randomly turn off the specified
fraction of nodes of the neural network during each epoch of training
making the NN more stable and less reliant on individual nodes/weights, which
can prevent over-fitting (only available for modes nn-class and nn-reg).
See mc_dropout setting explained below if dropout shall also be applied to the
predictions.</p></td>
    </tr>
    <tr>
      <th>mc_dropout</th>
      <td><p>logical. If set to TRUE, the predictions (including the
validation accuracy) based on a model trained with a dropout fraction &gt; 0
will reflect the stochasticity introduced by the dropout method (MC dropout
predictions). This is e.g. required when wanting to predict with a specified
accuracy threshold (see target_acc option in <code><a href='iucnn_predict_status.html'>iucnn_predict_status</a></code>).
This option is activated by default when chosing a dropout_rate &gt; 0, unless
it is manually set to FALSE here.</p></td>
    </tr>
    <tr>
      <th>mc_dropout_reps</th>
      <td><p>integer. The number of MC iterations to run when
predicting validation accuracy and calculating the accuracy-threshold
table required for making predictions with an accuracy threshold.
The default of 100 is usually sufficient, larger values will lead to longer
computation times, particularly during model testing with cross-validation.</p></td>
    </tr>
    <tr>
      <th>label_noise_factor</th>
      <td><p>numeric (only for mode nn-reg). Add specified amount
of random noise to the input labels to give the categorical labels a more
continuous spread before training the regression model. E.g. a value of 0.2
will redraw a label of a species categorized as Vulnerable (class=2) randomly
between 1.8 and 2.2, based on a uniform probability distribution.</p></td>
    </tr>
    <tr>
      <th>rescale_features</th>
      <td><p>logical. Set to TRUE if all feature values shall
be rescaled to values between 0 and 1 prior to training (default=FALSE).</p></td>
    </tr>
    <tr>
      <th>save_model</th>
      <td><p>logical. If TRUE the model is saved to disk.</p></td>
    </tr>
    <tr>
      <th>overwrite</th>
      <td><p>logical. If TRUE existing models are
overwritten. Default is set to FALSE.</p></td>
    </tr>
    <tr>
      <th>verbose</th>
      <td><p>Default 0, set to 1 for <code>iucnn_train_model</code> to print additional
info to the screen while training.</p></td>
    </tr>
    </table>

    <h2 class="hasAnchor" id="value"><a class="anchor" href="#value"></a>Value</h2>

    <p>outputs an <code>iucnn_model</code> object which can be used in
<code><a href='iucnn_predict_status.html'>iucnn_predict_status</a></code> for predicting the conservation status
of not evaluated species.</p>
    <h2 class="hasAnchor" id="note"><a class="anchor" href="#note"></a>Note</h2>

    <p>See <code><a href='../articles/Approximate_IUCN_Red_List_assessments_with_IUCNN.html'>vignette("Approximate_IUCN_Red_List_assessments_with_IUCNN")</a></code>
for a tutorial on how to run IUCNN.</p>

    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples"><div class='input'><span class='kw'>if</span> <span class='op'>(</span><span class='cn'>FALSE</span><span class='op'>)</span> <span class='op'>{</span>
<span class='fu'><a href='https://rdrr.io/r/utils/data.html'>data</a></span><span class='op'>(</span><span class='st'>"training_occ"</span><span class='op'>)</span> <span class='co'>#geographic occurrences of species with IUCN assessment</span>
<span class='fu'><a href='https://rdrr.io/r/utils/data.html'>data</a></span><span class='op'>(</span><span class='st'>"training_labels"</span><span class='op'>)</span><span class='co'># the corresponding IUCN assessments</span>
<span class='fu'><a href='https://rdrr.io/r/utils/data.html'>data</a></span><span class='op'>(</span><span class='st'>"prediction_occ"</span><span class='op'>)</span> <span class='co'>#occurrences from Not Evaluated species to prdict</span>

<span class='co'># 1. Feature and label preparation</span>
<span class='va'>features</span> <span class='op'>&lt;-</span> <span class='fu'><a href='iucnn_prepare_features.html'>iucnn_prepare_features</a></span><span class='op'>(</span><span class='va'>training_occ</span><span class='op'>)</span> <span class='co'># Training features</span>
<span class='va'>labels_train</span> <span class='op'>&lt;-</span> <span class='fu'><a href='iucnn_prepare_labels.html'>iucnn_prepare_labels</a></span><span class='op'>(</span><span class='va'>training_labels</span><span class='op'>)</span> <span class='co'># Training labels</span>
<span class='va'>features_predict</span> <span class='op'>&lt;-</span> <span class='fu'><a href='iucnn_prepare_features.html'>iucnn_prepare_features</a></span><span class='op'>(</span><span class='va'>prediction_occ</span><span class='op'>)</span> <span class='co'># Prediction features</span>

<span class='co'># 2. Model training</span>
<span class='va'>m1</span> <span class='op'>&lt;-</span> <span class='fu'>iucnn_train_model</span><span class='op'>(</span>x <span class='op'>=</span> <span class='va'>features</span>, lab <span class='op'>=</span> <span class='va'>labels_train</span><span class='op'>)</span>

<span class='fu'><a href='https://rdrr.io/r/base/summary.html'>summary</a></span><span class='op'>(</span><span class='va'>m1</span><span class='op'>)</span>
<span class='fu'><a href='https://rdrr.io/r/graphics/plot.default.html'>plot</a></span><span class='op'>(</span><span class='va'>m1</span><span class='op'>)</span>
<span class='op'>}</span>


</div></pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top">
      <h2 data-toc-skip>Contents</h2>
    </nav>
  </div>
</div>


      <footer>
      <div class="copyright">
  <p>Developed by Alexander Zizka.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.6.1.</p>
</div>

      </footer>
   </div>

  


  </body>
</html>


