<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>Train a CNN model — iucnn_cnn_train • IUCNN</title><!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous"><script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css"><script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet"><script src="../pkgdown.js"></script><meta property="og:title" content="Train a CNN model — iucnn_cnn_train"><meta property="og:description" content="Trains an CNN model based on a list of matrices with occurrence counts for a
set of species, generated by iucnn_cnn_features, and the
corresponding IUCN classes formatted as a iucnn_labels object with
iucnn_prepare_labels. Note that taxa for which information is
only present in one of the two input objects will be removed from further
processing."><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body data-spy="scroll" data-target="#toc">
    

    <div class="container template-reference-topic">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">IUCNN</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">3.0.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav"><li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu"><li>
      <a href="../articles/Approximate_IUCN_Red_List_assessments_with_IUCNN.html">Approximate Red List assessments with IUCNN</a>
    </li>
  </ul></li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul><ul class="nav navbar-nav navbar-right"><li>
  <a href="https://github.com/IUCNN/IUCNN/" class="external-link">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul></div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Train a CNN model</h1>
    <small class="dont-index">Source: <a href="https://github.com/IUCNN/IUCNN/blob/HEAD/R/iucnn_cnn_train.R" class="external-link"><code>R/iucnn_cnn_train.R</code></a></small>
    <div class="hidden name"><code>iucnn_cnn_train.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>Trains an CNN model based on a list of matrices with occurrence counts for a
set of species, generated by <code><a href="iucnn_cnn_features.html">iucnn_cnn_features</a></code>, and the
corresponding IUCN classes formatted as a iucnn_labels object with
<code><a href="iucnn_prepare_labels.html">iucnn_prepare_labels</a></code>. Note that taxa for which information is
only present in one of the two input objects will be removed from further
processing.</p>
    </div>

    <div id="ref-usage">
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">iucnn_cnn_train</span><span class="op">(</span></span>
<span>  <span class="va">x</span>,</span>
<span>  <span class="va">lab</span>,</span>
<span>  path_to_output <span class="op">=</span> <span class="st">"iuc_nn_model"</span>,</span>
<span>  production_model <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  cv_fold <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  test_fraction <span class="op">=</span> <span class="fl">0.2</span>,</span>
<span>  seed <span class="op">=</span> <span class="fl">1234</span>,</span>
<span>  max_epochs <span class="op">=</span> <span class="fl">100</span>,</span>
<span>  patience <span class="op">=</span> <span class="fl">20</span>,</span>
<span>  randomize_instances <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  balance_classes <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  dropout_rate <span class="op">=</span> <span class="fl">0</span>,</span>
<span>  mc_dropout_reps <span class="op">=</span> <span class="fl">100</span>,</span>
<span>  optimize_for <span class="op">=</span> <span class="st">"loss"</span>,</span>
<span>  pooling_strategy <span class="op">=</span> <span class="st">"average"</span>,</span>
<span>  save_model <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  overwrite <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  verbose <span class="op">=</span> <span class="fl">0</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div id="arguments">
    <h2>Arguments</h2>
    <dl><dt>x</dt>
<dd><p>a list of matrices containing the occurrence counts across a spatial
grid for a set of species.</p></dd>


<dt>lab</dt>
<dd><p>an object of the class iucnn_labels, as generated by
<code><a href="iucnn_prepare_labels.html">iucnn_prepare_labels</a></code> containing the labels for all species.</p></dd>


<dt>path_to_output</dt>
<dd><p>character string. The path to the location
where the IUCNN model shall be saved</p></dd>


<dt>production_model</dt>
<dd><p>an object of type iucnn_model (default=NULL).
If an iucnn_model is provided, <code>iucnn_cnn_train</code> will read the settings of
this model and reproduce it, but use all available data for training, by
automatically setting the validation set to 0 and cv_fold to 1. This is
recommended before using the model for predicting the IUCN status of
not evaluated species, as it generally improves the prediction
accuracy of the model. Choosing this option will ignore all other provided
settings below.</p></dd>


<dt>cv_fold</dt>
<dd><p>integer (default=1). When setting cv_fold &gt; 1,
<code>iucnn_cnn_train</code> will perform k-fold cross-validation. In this case,
the provided setting for test_fraction will be ignored, as the test size of
each CV-fold is determined by the specified number provided here.</p></dd>


<dt>test_fraction</dt>
<dd><p>numeric. The fraction of the input data used as test set.</p></dd>


<dt>seed</dt>
<dd><p>integer. Set a starting seed for reproducibility.</p></dd>


<dt>max_epochs</dt>
<dd><p>integer. The maximum number of epochs.</p></dd>


<dt>patience</dt>
<dd><p>integer. Number of epochs with no improvement after which
training will be stopped.</p></dd>


<dt>randomize_instances</dt>
<dd><p>logical (default=TRUE). When set to TRUE (default)
the instances will be shuffled before training (recommended).</p></dd>


<dt>balance_classes</dt>
<dd><p>logical (default=FALSE). If set to TRUE,
<code>iucnn_cnn_train</code> will perform supersampling of the training instances to
account for uneven class distribution in the training data.</p></dd>


<dt>dropout_rate</dt>
<dd><p>numeric. This will randomly turn off the specified
fraction of nodes of the neural network during each epoch of training
making the NN more stable and less reliant on individual nodes/weights, which
can prevent over-fitting (only available for modes nn-class and nn-reg).
See mc_dropout setting explained below if dropout shall also be applied to the
predictions. For models trained with a dropout fraction &gt; 0, the predictions
(including the validation accuracy)
will reflect the stochasticity introduced by the dropout method (MC dropout
predictions). This is e.g. required when wanting to predict with a specified
accuracy threshold (see target_acc option in
<code><a href="iucnn_predict_status.html">iucnn_predict_status</a></code>).</p></dd>


<dt>mc_dropout_reps</dt>
<dd><p>integer. The number of MC iterations to run when
predicting validation accuracy and calculating the accuracy-threshold
table required for making predictions with an accuracy threshold.
The default of 100 is usually sufficient, larger values will lead to longer
computation times, particularly during model testing with cross-validation.</p></dd>


<dt>optimize_for</dt>
<dd><p>string. Default is "loss", which will train the model
until optimal validation set loss is reached. Set to "accuracy" if you want
to optimize for maximum validation accuracy instead.</p></dd>


<dt>pooling_strategy</dt>
<dd><p>string. Pooling strategy after first convolutional
layer. Choose between  "average" (default) and "max".</p></dd>


<dt>save_model</dt>
<dd><p>logical. If TRUE the model is saved to disk.</p></dd>


<dt>overwrite</dt>
<dd><p>logical. If TRUE existing models are
overwritten. Default is set to FALSE.</p></dd>


<dt>verbose</dt>
<dd><p>Default 0, set to 1 for <code>iucnn_cnn_train</code> to print
additional info to the screen while training.</p></dd>

</dl></div>
    <div id="value">
    <h2>Value</h2>
    

<p>outputs an <code>iucnn_model</code> object which can be used in
<code><a href="iucnn_predict_status.html">iucnn_predict_status</a></code> for predicting the conservation status
of not evaluated species.</p>
    </div>
    <div id="note">
    <h2>Note</h2>
    <p>See <code><a href="../articles/Approximate_IUCN_Red_List_assessments_with_IUCNN.html">vignette("Approximate_IUCN_Red_List_assessments_with_IUCNN")</a></code>
for a tutorial on how to run IUCNN.</p>
    </div>

    <div id="ref-examples">
    <h2>Examples</h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="kw">if</span> <span class="op">(</span><span class="cn">FALSE</span><span class="op">)</span> <span class="op">{</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="st">"training_occ"</span><span class="op">)</span> <span class="co">#geographic occurrences of species with IUCN assessment</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="st">"training_labels"</span><span class="op">)</span><span class="co"># the corresponding IUCN assessments</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">cnn_training_features</span> <span class="op">&lt;-</span> <span class="fu"><a href="iucnn_cnn_features.html">iucnn_cnn_features</a></span><span class="op">(</span><span class="va">training_occ</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">cnn_labels</span> <span class="op">&lt;-</span> <span class="fu"><a href="iucnn_prepare_labels.html">iucnn_prepare_labels</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">training_labels</span>,</span></span>
<span class="r-in"><span>                     y <span class="op">=</span> <span class="va">cnn_training_features</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">trained_model</span> <span class="op">&lt;-</span> <span class="fu">iucnn_cnn_train</span><span class="op">(</span><span class="va">cnn_training_features</span>,</span></span>
<span class="r-in"><span>                                <span class="va">cnn_labels</span>,</span></span>
<span class="r-in"><span>                                overwrite <span class="op">=</span> <span class="cn">TRUE</span>,</span></span>
<span class="r-in"><span>                                dropout <span class="op">=</span> <span class="fl">0.1</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">trained_model</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">}</span></span></span>
<span class="r-in"><span></span></span>
</code></pre></div>
    </div>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top"><h2 data-toc-skip>Contents</h2>
    </nav></div>
</div>


      <footer><div class="copyright">
  <p></p><p>Developed by Alexander Zizka.</p>
</div>

<div class="pkgdown">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

      </footer></div>

  


  

  </body></html>

